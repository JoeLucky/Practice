<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title></title>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
</head>
<body>
<pre>
    function strLength(s, bUnicode255For1) {
        return bUnicode255For1 ? s.length : (function () {
            var len = 0;
            for (var i = 0; i < s.length; ++i) {
                len += s.charCodeAt(i) > 255 ? 2 : 1;
            }
            return len;
        })()
    }
</pre>
<script>
    function strLength(s, bUnicode255For1) {
        return bUnicode255For1 ? s.length : (function () {
            var len = 0;
            for (var i = 0; i < s.length; ++i) {
                len += s.charCodeAt(i) > 255 ? 2 : 1;
            }
            return len;
        })()
    }
    /* Test */
    var testStr = 'hello World, 你好世界';
    console.log(strLength(testStr, false));
</script>
</body>
</html>